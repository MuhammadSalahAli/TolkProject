import{AbstractRouter}from"./communication.js";export class Router extends AbstractRouter{getRoute(route_name,...args){if(!route_name){throw new Error("Expected args not provided")}else{let route=routes[route_name];if(!route){throw new Error("route dose not exist")}else{if(route.protocol.match(/http/i)&&route["method"]&&route["url_pattern"]){return{protocol:route["protocol"],method:route["method"],url:window.location.protocol+"//"+window.location.host+this.constructUrl(route["url_pattern"],args)}}else if(route["protocol"].match(/websocket/i)&&route["url"]){return{protocol:route["protocol"],url:route["url"]}}else{throw new Error("Invalid url")}}}}validate_url(url_pattern){if(!url_pattern.match(/^\//)){throw new Error("Missing beginning slash in url")}else if(!url_pattern.match(/\/$/)){throw new Error("Missing the last slash in url")}else if(url_pattern.match(/<[0-9][A-Za-z0-9_]+>\//)){throw new Error(`url parameter ${url_pattern.match(/<[\W0-9][A-Za-z0-9_]*>\//g)} name can only start with letter [a-zA-Z]`)}}constructUrl(url_pattern,...args){this.validate_url(url_pattern);let url_parameters=url_pattern.match(/<[A-Za-z][A-Za-z0-9_]+>\//g);if(url_parameters){for(let count=0;count<args[0].length;count++){if(!url_parameters[count]){throw new Error("Too much arguments")}else{let url_parameter_name=url_parameters[count].match(/[A-Za-z][A-Za-z0-9_]+/)[0];if(!url_parameter_name){throw new Error("invalid url pattern")}else{url_pattern=url_pattern.replace(new RegExp(`<${url_parameter_name}>`),args[0][count])}}}}return url_pattern}};let routes={"contact-list":{protocol:"http",method:"GET",url_pattern:"/api/contacts/"},"contact-detail":{protocol:"http",method:"GET",url_pattern:`/api/contacts/<pk>/`},"contact-create":{protocol:"http",method:"POST",url_pattern:"/api/contacts/"},"contact-update":{protocol:"http",method:"PUT",url_pattern:`/api/contacts/<pk>/`},"contact-partial-update":{protocol:"http",method:"PATCH",url_pattern:"/api/contacts/<pk>/"},"add-friend":{protocol:"http",method:"POST",url_pattern:"/api/add-friend/"},"contact-delete":{protocol:"http",method:"DELETE",url_pattern:"/api/contact/<pk>/"},"user-create":{protocol:"http",method:"POST",url_pattern:"/api/users/"},"user-update":{protocol:"http",method:"PUT",url_pattern:"/api/users/<pk>/"},"user-partial":{protocol:"http",method:"PATCH",url_pattern:"/api/users/<pk>/"},"user-delete":{protocol:"http",method:"DELETE",url_pattern:"/api/users/<pk>/"},register:{protocol:"http",method:"POST",url_pattern:"/api/register/"},login:{protocol:"http",method:"POST",url_pattern:"/api/login/"},logout:{protocol:"http",method:"POST",url_pattern:"/api/logout/"},authenticated:{protocol:"http",method:"GET",url_pattern:"/api/authenticated/"},"conversation-list":{protocol:"http",method:"GET",url_pattern:"/api/conversations/"},"conversation-detail":{protocol:"http",method:"GET",url_pattern:"/api/conversations/<pk>/"},"conversation-create":{protocol:"http",method:"POST",url_pattern:"/api/conversations/"},"conversation-update":{protocol:"http",method:"PUT",url_pattern:"/api/conversations/<pk>/"},"conversation-partial-update":{protocol:"http",method:"PATCH",url_pattern:"/api/conversations/<pk>/"},"conversation-delete":{protocol:"http",method:"DELETE",url_pattern:"/api/conversations/<pk>/"},"create-group":{protocol:"http",method:"POST",url_pattern:"/api/create-group/"},"notification-list":{protocol:"http",method:"GET",url_pattern:"/api/notifications/"},"notification-detail":{protocol:"http",method:"GET",url_pattern:"/api/notifications/<pk>/"},"notification-create":{protocol:"http",method:"POST",url_pattern:"/api/notifications/"},"notification-update":{protocol:"http",method:"PUT",url_pattern:"/api/notifications/<pk>/"},"notification-partial-update":{protocol:"http",method:"PATCH",url_pattern:"/api/notifications/<pk>/"},"notification-delete":{protocol:"http",method:"DELETE",url_pattern:"/api/notifications/<pk>/"},"message-list":{protocol:"http",method:"GET",url_pattern:"/api/messages/"},"message-detail":{protocol:"http",method:"GET",url_pattern:"/api/messages/<pk>/"},"message-create":{protocol:"http",method:"POST",url_pattern:"/api/messages/"},"message-update":{protocol:"http",method:"PUT",url_pattern:"/api/messages/<pk>/"},"message-partial-update":{protocol:"http",method:"PATCH",url_pattern:"/api/messages/<pk>/"},"message-delete":{protocol:"http",method:"DELETE",url_pattern:"/api/messages/<pk>/"},"send-attachment":{protocol:"http",method:"POST",url_pattern:"/api/send-attachments/"},"settings-detail":{protocol:"http",method:"GET",url_pattern:"/api/settings/<pk>/"},"settings-create":{protocol:"http",method:"POST",url_pattern:"/api/settings/"},"change-settings":{protocol:"http",method:"POST",url_pattern:"/api/change-settings/"},"chat-socket":{protocol:"websockets",url:"/ws/chat/"}};